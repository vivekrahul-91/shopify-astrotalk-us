{% schema %}
{
  "name": "Consultation Section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Consultation"
    },
    {
      "type": "text",
      "id": "consultation_title",
      "label": "Consultation Title",
      "default": "Free Consultation from Rudraksha Expert"
    },
    {
      "type": "text",
      "id": "consultation_description",
      "label": "Consultation Description",
      "default": "Our expert will personally call you to help choose the right Rudraksha based on your needs and astrology, guiding you on how to wear, cleanse, and energize the beads for maximum benefits."
    },
    {
      "type": "url",
      "id": "recommender_url",
      "label": "Rudraksha Recommender URL"
    },
    {
      "type": "image_picker",
      "id": "background_image",
      "label": "Background Image"
    }
  ],
  "presets": [
    {
      "name": "Consultation Section",
      "category": "Custom"
    }
  ]
}
{% endschema %}

<style>
  .consultation-section {
    padding: 40px 20px;
    position: relative;
    overflow: hidden;
  }
  
  .consultation-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: -1;
    background-size: cover;
    background-position: center;
    opacity: 0.15;
  }
  
  .consultation-container {
    max-width: 1200px;
    margin: 0 auto;
  }
  
  .consultation-heading {
    text-align: center;
    margin-bottom: 30px;
  }
  
  .consultation-tabs {
    display: flex;
    justify-content: center;
    gap: 20px;
    margin-bottom: 40px;
  }
  
  .consultation-tab {
    padding: 12px 24px;
    cursor: pointer;
    text-align: center;
    border-radius: 5px;
    font-weight: medium;
    width: 100%;
    max-width: 300px;
    transition: all 0.3s ease;
  }
  
.consultation-tab.active {
    color: white;
    border-radius: 10px;
    background: #9F4723;
    box-shadow: 0px 2px 2px 0px rgba(0, 0, 0, 0.20);
}
  .consultation-tab.inactive{
    color: #9F4723;
    border-radius: 10px;
    border: 0.25px solid #9F4723;
    background: #FFF;
    box-shadow: 0px 2px 2px 0px rgba(0, 0, 0, 0.20);
}
  
  .consultation-tab-content {
    display: flex;
    flex-wrap: wrap;
    gap: 30px;
    align-items: center;
  }
  
  .consultation-info {
    flex: 1;
    min-width: 300px;
    padding: 50px 0px;
  }
  
  .consultation-form {
    flex: 1;
    min-width: 300px;
  }
  
  .consultation-form-fields {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }
  
  .consultation-input {
    padding: 12px;
    border: 1px solid #e5e5e5;
    border-radius: 5px;
    width: 100%;
  }
  
  .consultation-submit {
    background-color: #B6522C;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 5px;
    cursor: pointer;
    margin-top: 15px;
    transition: all 0.3s ease;
  }
  
  .consultation-submit:hover {
    background-color: #9F4723;
  }
  .consultation-info h3 {
    font-size: 20px;
    margin-bottom: 10px;
}
  .consultation-info p{
    font-size: 15px;
}
  .sk-form-wrapper .rudraksha-cform {
    background-image: url(https://cdn.shopify.com/s/files/1/0878/4907/4985/files/gif_2.gif?v=1749021806);
    background-size: contain;
    background-position-x: center;
    background-repeat: no-repeat;
    background-position-y: center;
}
  .consultation-section {
    padding: 40px 20px 65px;
    position: relative;
    overflow: hidden;
    background-image: url(https://cdn.shopify.com/s/files/1/0878/4907/4985/files/background_for_web.png?v=1749029355);
    background-repeat: no-repeat;
    background-position: right;
    background-size: cover;
}
  @media screen and (max-width: 768px) {
    .consultation-tabs {
      flex-direction: column;
      align-items: center;
      gap:15px;
    }
    .consultation-info{
      padding:0 20px;
    }
    .consultation-section {
        background-image: url(https://cdn.shopify.com/s/files/1/0878/4907/4985/files/background_for_phone_2.png?v=1749029354);
        padding: 40px 0px 50px;
        margin-top: 50px;
     }
    .consultation-tab {
      width: 100%;
    }
  }
</style>

<div class="consultation-section">
  {% if section.settings.background_image %}
    <div class="consultation-background" style="background-image: url('{{ section.settings.background_image | img_url: 'master' }}');"></div>
  {% else %}
    <div class="consultation-background" style="background-image: url('{{ 'consultant-bg.gif' | asset_url }}');"></div>
  {% endif %}
  
  <div class="consultation-container">
    <h2 class="consultation-heading">{{ section.settings.heading | default: "Consultation" }}</h2>
    
    <div class="consultation-tabs">
      <div class="consultation-tab active" id="free-consultation-tab">
        Free Consultation
      </div>
      <div class="consultation-tab inactive" id="recommender-tab">
        <a href="{{ section.settings.recommender_url }}">
        Rudraksha Recommender
        </a>
      </div>
    </div>
    
    <div class="consultation-tab-content" id="consultation-content">
      <div class="consultation-info">
        <h3>{{ section.settings.consultation_title | default: "Free Consultation from Rudraksha Expert" }}</h3>
        <p>{{ section.settings.consultation_description | default: "Our expert will personally call you to help choose the right Rudraksha based on your needs and astrology, guiding you on how to wear, cleanse, and energize the beads for maximum benefits." }}</p>
      </div>
      
      <div class="consultation-form">
        <div class="sk-form-wrapper">
          {% render 'rudraksha-consult-form' %}
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const consultationTab = document.getElementById('free-consultation-tab');
    const recommenderTab = document.getElementById('recommender-tab');
    const consultationContent = document.getElementById('consultation-content');
    const skForm = document.querySelector('.sk-form-wrapper');
    const fallbackForm = document.querySelector('.fallback-form');
    
    // Check if SquadKin form loaded properly
    setTimeout(function() {
      if (!document.querySelector('.sk-form iframe')) {
        fallbackForm.style.display = 'flex';
      }
    }, 2000);
    
    // Handle tab switching
    consultationTab.addEventListener('click', function() {
      consultationTab.classList.add('active');
      consultationTab.classList.remove('inactive');
      recommenderTab.classList.add('inactive');
      recommenderTab.classList.remove('active');
      consultationContent.style.display = 'flex';
    });
    
    recommenderTab.addEventListener('click', function() {
      window.location.href = '{{ section.settings.recommender_url | default: "/pages/rudraksha-recommender" }}';
    });
  });
</script>